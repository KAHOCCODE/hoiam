<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>H·ªìi‚ÄØ√Çm‚ÄØƒêam‚ÄØM·ªπ‚ÄØ‚Äì‚ÄØV≈©‚ÄØTr·ª•‚ÄØTruy·ªán</title>
<link rel="icon" type="image/x-icon" href="favicon.ico">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
  body{font-family:'Poppins',sans-serif;color:#222;overflow-x:hidden;margin:0;}
  /* N·ªÅn ng√¢n h√† */
  canvas#stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-10;display:block;}
  
  /* Hi·ªáu ·ª©ng k√≠nh */
  .glass{background:rgba(255,255,255,0.93);backdrop-filter:blur(12px);
    border:1px solid rgba(255,255,255,0.5);border-radius:20px;
    box-shadow:0 8px 32px rgba(31, 38, 135, 0.15);}
  
  /* Gradient & Buttons */
  .btn-gradient{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;
    border:none;border-radius:30px;font-weight:600;transition:all 0.3s ease;}
  .btn-gradient:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(118, 75, 162, 0.4);}
  .text-gradient {background: -webkit-linear-gradient(#667eea, #764ba2);-webkit-background-clip: text;-webkit-text-fill-color: transparent;}
  
  /* Tab Button Logic */
  .tab-btn {white-space: nowrap;} /* Gi·ªØ text tr√™n 1 d√≤ng */
  .tab-btn.active {background: #764ba2; color: white; border-color: #764ba2; box-shadow: 0 4px 6px rgba(118, 75, 162, 0.3);}
  
  /* ·∫®n thanh cu·ªôn cho Tabs tr√™n mobile */
  .scrollbar-hide::-webkit-scrollbar {display: none;}
  .scrollbar-hide {-ms-overflow-style: none; scrollbar-width: none;}

  /* Vinyl Record */
  .vinyl-record {width:36px;height:36px;border-radius:50%;background:radial-gradient(circle at center,#d32f2f 20%,transparent 20%),radial-gradient(circle at center,#fff 20%,#fff 22%,transparent 22%),repeating-radial-gradient(circle at center,#111 0,#111 2px,#333 3px,#333 4px);position:relative;border:2px solid #111;animation:vinyl-spin 4s linear infinite;box-shadow:0 2px 5px rgba(0,0,0,0.5);}
  .vinyl-record::after {content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:4px;height:4px;background:#fff;border-radius:50%;}
  @keyframes vinyl-spin {from{transform:rotate(0deg);}to{transform:rotate(360deg);}}

  /* Loader */
  .loader {border:4px solid #f3f3f3;border-top:4px solid #764ba2;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:20px auto;}
  @keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
</style>
</head>

<body>

<canvas id="stars"></canvas>
<script>
const c=document.getElementById("stars"),x=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight;}window.onresize=resize;resize();
const stars=[...Array(150)].map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*1.5,dx:(Math.random()-.5)*0.2,dy:(Math.random()-.5)*0.2}));
function draw(){
 x.clearRect(0,0,c.width,c.height);
 const g=x.createLinearGradient(0,0,c.width,c.height);g.addColorStop(0,"#0f0c29");g.addColorStop(0.5,"#302b63");g.addColorStop(1,"#24243e");
 x.fillStyle=g;x.fillRect(0,0,c.width,c.height);
 x.fillStyle="#fff";
 stars.forEach(s=>{x.beginPath();x.arc(s.x,s.y,s.r,0,Math.PI*2);x.fill();s.x+=s.dx;s.y+=s.dy;if(s.x<0)s.x=c.width;if(s.x>c.width)s.x=0;if(s.y<0)s.y=c.height;if(s.y>c.height)s.y=0;});
 requestAnimationFrame(draw);
}draw();
</script>

<nav class="fixed w-full backdrop-blur-md bg-white/80 shadow-md z-50">
  <div class="max-w-7xl mx-auto flex items-center justify-between p-4">
    <a href="#home" class="text-2xl font-bold flex items-center gap-3 hover:opacity-80 transition">
      <div class="vinyl-record"></div>
      <span class="text-gradient hidden sm:block">H·ªìi‚ÄØ√Çm‚ÄØƒêam‚ÄØM·ªπ</span>
      <span class="text-gradient sm:hidden">H·ªìi‚ÄØ√Çm</span> </a>
    <button id="menuBtn" class="sm:hidden text-2xl text-indigo-700 px-2"><i class="fa-solid fa-bars"></i></button>
    <div id="navLinks" class="hidden sm:flex flex-col sm:flex-row sm:items-center sm:space-x-8 absolute sm:static w-full sm:w-auto bg-white sm:bg-transparent left-0 top-16 sm:top-auto shadow-lg sm:shadow-none p-4 sm:p-0 rounded-b-xl font-medium text-gray-700">
      <a href="#suggest" class="block py-3 hover:text-indigo-600 border-b sm:border-0"><i class="fa-solid fa-pen-nib mr-1"></i> ƒê·ªÅ‚ÄØxu·∫•t</a>
      <a href="#main-content" class="block py-3 hover:text-indigo-600 border-b sm:border-0"><i class="fa-solid fa-layer-group mr-1"></i> Kho Truy·ªán</a>
      <a href="#reading" class="block py-3 hover:text-indigo-600 border-b sm:border-0"><i class="fa-solid fa-headphones mr-1"></i> Audio</a>
      <button id="adminLoginBtn" class="text-pink-600 text-lg hover:text-pink-400 py-2" title="Qu·∫£n tr·ªã"><i class="fa-solid fa-user-shield"></i></button>
    </div>
  </div>
</nav>
<script>document.getElementById('menuBtn').addEventListener('click',()=>document.getElementById('navLinks').classList.toggle('hidden'));</script>

<section id="home" class="pt-32 pb-6 text-center text-white px-4">
  <h2 class="text-3xl sm:text-4xl font-bold mb-8 drop-shadow-lg uppercase tracking-wider">üëë B·∫£ng V√†ng üëë</h2>
  <div id="loadingTop" class="loader"></div>
  <div id="topStories" class="flex flex-wrap justify-center gap-6"></div>
</section>

<section id="suggest" class="max-w-4xl mx-auto mt-6 p-6 sm:p-10 glass mx-4 shadow-xl">
  <h2 class="text-2xl font-bold text-center mb-6 text-gray-800"><i class="fa-solid fa-paper-plane text-indigo-500"></i> G·ª≠i ƒê·ªÅ Xu·∫•t</h2>
  <form id="formSuggest" class="grid gap-5">
    <div class="grid sm:grid-cols-2 gap-4">
      <input id="title" class="p-3 rounded-xl border w-full outline-none focus:border-indigo-500 bg-white/50" placeholder="T√™n truy·ªán..." required>
      <input id="linkStory" type="url" class="p-3 rounded-xl border w-full outline-none focus:border-indigo-500 bg-white/50" placeholder="Link ƒë·ªçc (n·∫øu c√≥)...">
    </div>
    <div class="flex flex-wrap items-center gap-4 bg-white/30 p-2 rounded-lg">
      <label class="flex items-center gap-2 cursor-pointer select-none"><input type="radio" name="version" value="Edit" class="accent-indigo-600" required> Edit</label>
      <label class="flex items-center gap-2 cursor-pointer select-none"><input type="radio" name="version" value="Convert" class="accent-pink-600"> Convert</label>
    </div>
    <textarea id="note" class="p-3 rounded-xl border w-full outline-none focus:border-indigo-500 bg-white/50" rows="2" placeholder="Review ng·∫Øn / C·∫£nh b√°o..."></textarea>
    <button class="py-3 btn-gradient text-lg shadow-lg w-full sm:w-auto mx-auto px-10 active:scale-95 transition">G·ª¨I NGAY</button>
  </form>
</section>

<section id="reading" class="max-w-6xl mx-auto mt-16 p-4 sm:p-8 glass mx-4 border-l-8 border-green-400">
  <h2 class="text-2xl sm:text-3xl font-bold mb-6 text-gray-800 flex items-center gap-3">
    <span class="bg-green-100 text-green-600 p-2 rounded-full text-xl"><i class="fa-solid fa-podcast"></i></span> 
    ƒêang L√™n S√≥ng
  </h2>
  <div id="readingList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
</section>

<section id="main-content" class="max-w-7xl mx-auto mt-16 p-4 sm:p-8 glass mx-4 mb-20">
  
  <div class="flex overflow-x-auto scrollbar-hide gap-2 mb-6 border-b pb-4 px-1">
    <button onclick="switchTab('tabSuggest')" class="tab-btn active px-5 py-2 rounded-full border border-gray-300 font-medium text-sm sm:text-base text-gray-600 hover:bg-gray-50 transition"><i class="fa-solid fa-list mr-1"></i>ƒê·ªÅ Xu·∫•t</button>
    <button onclick="switchTab('tabCompleted')" class="tab-btn px-5 py-2 rounded-full border border-gray-300 font-medium text-sm sm:text-base text-gray-600 hover:bg-gray-50 transition"><i class="fa-solid fa-check-circle mr-1"></i>Ho√†n Th√†nh</button>
    <button onclick="switchTab('tabDrop')" class="tab-btn px-5 py-2 rounded-full border border-gray-300 font-medium text-sm sm:text-base text-gray-600 hover:bg-gray-50 transition"><i class="fa-solid fa-ban mr-1"></i>Drop</button>
  </div>

  <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-3">
    <h3 id="tabTitle" class="text-lg sm:text-xl font-bold text-indigo-800 text-center md:text-left">Danh S√°ch ƒê·ªÅ Xu·∫•t</h3>
    <div class="flex gap-2 w-full md:w-auto">
      <input id="searchInput" class="p-2 px-4 rounded-full border focus:outline-none w-full bg-white" placeholder="üîç T√¨m ki·∫øm..." onkeyup="refreshCurrentTab()">
      <select id="sortSelect" class="p-2 px-4 rounded-full border bg-white focus:outline-none" onchange="refreshCurrentTab()">
        <option value="new">M·ªõi nh·∫•t</option>
        <option value="vote">Vote cao</option>
      </select>
    </div>
  </div>

  <div id="loadingList" class="loader"></div>

  <div id="tableContainer" class="min-h-[300px]">
    </div>
</section>

<section id="admin" class="hidden max-w-7xl mx-auto mt-10 mb-10 p-6 glass mx-4 border-2 border-red-200">
  <div class="flex justify-between items-center mb-6 border-b pb-4">
    <h2 class="text-2xl font-bold text-red-600">Admin Zone</h2>
    <button class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-800" id="logoutBtn">Tho√°t</button>
  </div>
  <div class="overflow-x-auto max-h-[500px]">
    <table class="w-full text-center table text-sm">
      <thead class="sticky top-0 shadow"><tr><th class="p-3">T√™n</th><th>Status</th><th>Link</th><th>Act</th></tr></thead>
      <tbody id="adminTable" class="bg-white"></tbody>
    </table>
  </div>
</section>

<footer><p>¬© 2025 H·ªìi √Çm ƒêam M·ªπ</p></footer>

<script>
const SUPABASE_URL='https://xklmcebwxkqbotqexprn.supabase.co';
const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhrbG1jZWJ3eGtxYm90cWV4cHJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2MzM1NDEsImV4cCI6MjA3OTIwOTU0MX0.vZj-5C_HhVgemG0LOTH3axf4P0bxXngzeQ3PSo93-m4';
const TABLE='stories';
let stories=[];
let currentTab = 'tabSuggest';

async function fetchStories(){
  document.getElementById('loadingTop').style.display='block';
  document.getElementById('loadingList').style.display='block';
  try {
    const res=await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}?select=*`,{headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
    if(!res.ok) throw new Error();
    stories=await res.json();
    refreshAll();
  } catch(e) {Swal.fire('L·ªói','Kh√¥ng t·∫£i ƒë∆∞·ª£c d·ªØ li·ªáu','error');} 
  finally {
    document.getElementById('loadingTop').style.display='none';
    document.getElementById('loadingList').style.display='none';
  }
}

async function addStory(s){
  Swal.fire({title:'ƒêang g·ª≠i...',didOpen:()=>{Swal.showLoading()}});
  const res=await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}`,{
    method:'POST',headers:{'Content-Type':'application/json',apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`,Prefer:'return=representation'},
    body:JSON.stringify(s)
  });
  if(res.ok){const data=await res.json();stories.push(data[0]);refreshAll();Swal.fire('Th√†nh c√¥ng','ƒê√£ g·ª≠i ƒë·ªÅ xu·∫•t!','success');}
}

async function updateStory(id,d){
  await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}?id=eq.${id}`,{method:'PATCH',headers:{'Content-Type':'application/json',apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`},body:JSON.stringify(d)});
  fetchStories();
}

async function deleteStory(id){
  const cf=await Swal.fire({title:'X√≥a?',icon:'warning',showCancelButton:true,confirmButtonColor:'#d33'});
  if(cf.isConfirmed){
    await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}?id=eq.${id}`,{method:'DELETE',headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
    stories=stories.filter(s=>s.id!==id);refreshAll();Swal.fire('ƒê√£ x√≥a','','success');
  }
}

async function toggleVote(id){
  const key=`vote_${id}`,st=stories.find(s=>s.id===id);if(!st)return;
  let v=st.votes||0;
  if(localStorage.getItem(key)){localStorage.removeItem(key);v=Math.max(0,v-1);}else{localStorage.setItem(key,'true');v++;}
  st.votes=v; refreshAll(); await updateStory(id,{votes:v});
}
function userVoted(id){return localStorage.getItem(`vote_${id}`);}

function switchTab(tabName){
  currentTab = tabName;
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  event.target.closest('button').classList.add('active');
  const titles = {'tabSuggest': 'Kho ƒê·ªÅ Xu·∫•t', 'tabCompleted': 'ƒê√£ Ho√†n Th√†nh', 'tabDrop': 'Truy·ªán Drop/Ng∆∞ng'};
  document.getElementById('tabTitle').innerText = titles[tabName];
  refreshCurrentTab();
}

function refreshAll(){renderTop();renderReading();renderAdmin();refreshCurrentTab();}

function refreshCurrentTab(){
  const keyword = document.getElementById('searchInput').value.toLowerCase();
  const sortMode = document.getElementById('sortSelect').value;
  let filterStatus = [];
  
  if(currentTab === 'tabSuggest') filterStatus = ['ƒë·ªÅ‚ÄØxu·∫•t', 'ƒë·ªÅ xu·∫•t'];
  else if(currentTab === 'tabCompleted') filterStatus = ['ƒë√£‚ÄØƒë·ªçc', 'ƒë√£ ƒë·ªçc', 'ho√†n th√†nh'];
  else if(currentTab === 'tabDrop') filterStatus = ['drop', 't·∫°m ng∆∞ng'];

  let list = stories.filter(s => filterStatus.includes(s.status.toLowerCase().replace(/\u00a0/g, ' ')) && s.title.toLowerCase().includes(keyword));
  if(sortMode === 'vote') list.sort((a,b) => b.votes - a.votes);
  else list.sort((a,b) => new Date(b.createdat) - new Date(a.createdat));

  renderResponsiveTable(list);
}

// === RENDER TH√îNG MINH (PC vs MOBILE) ===
function renderResponsiveTable(list){
  const container = document.getElementById('tableContainer');
  if(list.length === 0){container.innerHTML = '<div class="text-center p-10 text-gray-500 italic">Ch∆∞a c√≥ d·ªØ li·ªáu...</div>'; return;}

  // 1. T·∫°o HTML cho B·∫£ng (Ch·ªâ hi·ªán tr√™n m√†n h√¨nh l·ªõn: md:block)
  let tableHtml = `
  <div class="hidden md:block overflow-x-auto rounded-xl shadow-sm">
    <table class="w-full text-left border-collapse">
      <thead class="text-white h-12" style="background:linear-gradient(90deg,#667eea,#764ba2)">
        <tr><th class="p-4 rounded-tl-xl">Truy·ªán</th><th>Lo·∫°i</th><th>Ghi ch√∫</th><th class="text-center">Vote</th><th class="p-4 rounded-tr-xl text-center">Link</th></tr>
      </thead>
      <tbody class="bg-white/80">`;

  list.forEach(s => {
    tableHtml += `
    <tr class="border-b hover:bg-purple-50 transition">
      <td class="p-4 font-medium text-gray-800">${s.title} ${currentTab==='tabCompleted' ? '<i class="fa-solid fa-circle-check text-green-500 ml-1"></i>' : ''}</td>
      <td class="p-4"><span class="px-2 py-1 text-xs rounded bg-gray-100">${s.version}</span></td>
      <td class="p-4 text-sm text-gray-500 max-w-xs truncate" title="${s.note}">${s.note||'-'}</td>
      <td class="p-4 text-center"><button onclick="toggleVote(${s.id})" class="${userVoted(s.id)?'text-red-500':'text-gray-300 hover:text-red-400'}"><i class="fa-solid fa-heart"></i></button> <span class="text-xs font-bold">${s.votes}</span></td>
      <td class="p-4 text-center">${s.linkstory ? `<a href="${s.linkstory}" target="_blank" class="text-indigo-600 text-lg"><i class="fa-solid fa-book-open"></i></a>` : ''}</td>
    </tr>`;
  });
  tableHtml += `</tbody></table></div>`;

  // 2. T·∫°o HTML cho Th·∫ª Card (Ch·ªâ hi·ªán tr√™n mobile: md:hidden)
  let mobileHtml = `<div class="md:hidden space-y-3">`;
  list.forEach(s => {
    mobileHtml += `
    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex justify-between relative overflow-hidden">
      <div class="absolute top-0 left-0 w-1 h-full ${s.version==='Edit'?'bg-indigo-500':'bg-pink-500'}"></div>
      <div class="flex-1 pr-2 pl-2">
        <h4 class="font-bold text-gray-800 text-lg leading-tight mb-1">${s.title}</h4>
        <p class="text-xs text-gray-500 mb-2 line-clamp-2">${s.note||'...'}</p>
        <div class="flex items-center gap-2">
           <span class="text-[10px] bg-gray-100 px-2 py-0.5 rounded text-gray-600 border">${s.version}</span>
           ${s.linkstory ? `<a href="${s.linkstory}" target="_blank" class="text-[10px] bg-indigo-50 text-indigo-700 px-2 py-0.5 rounded border border-indigo-100 font-medium">ƒê·ªçc ngay <i class="fa-solid fa-chevron-right text-[8px]"></i></a>` : ''}
        </div>
      </div>
      <div class="flex flex-col items-center justify-center pl-3 border-l border-gray-100 min-w-[50px]">
         <button onclick="toggleVote(${s.id})" class="text-2xl mb-1 transition active:scale-125 ${userVoted(s.id)?'text-red-500':'text-gray-300'}"><i class="fa-solid fa-heart"></i></button>
         <span class="text-xs font-bold text-gray-600">${s.votes}</span>
      </div>
    </div>`;
  });
  mobileHtml += `</div>`;

  // G·ªôp c·∫£ 2 l·∫°i (CSS s·∫Ω quy·∫øt ƒë·ªãnh c√°i n√†o hi·ªán ra t√πy thi·∫øt b·ªã)
  container.innerHTML = tableHtml + mobileHtml;
}

function renderTop(){
  const top = [...stories.filter(s=>['ƒë·ªÅ‚ÄØxu·∫•t','ƒë·ªÅ xu·∫•t'].includes(s.status.toLowerCase().replace(/\u00a0/g, ' ')))].sort((a,b)=>b.votes-a.votes).slice(0,3);
  document.getElementById('topStories').innerHTML = top.map((s,i)=>`
    <div class="w-60 p-5 bg-white/90 rounded-2xl shadow-lg relative transform hover:-translate-y-2 transition text-gray-800">
      <div class="absolute -top-3 -left-3 w-8 h-8 rounded-full bg-yellow-400 text-white flex items-center justify-center font-bold shadow">#${i+1}</div>
      <h5 class="font-bold text-indigo-800 mb-1 line-clamp-2">${s.title}</h5>
      <div class="flex justify-between items-center mt-2"><span class="text-pink-600 text-sm font-bold">${s.votes} <i class="fa-solid fa-heart"></i></span></div>
    </div>`).join('');
}

function renderReading(){
  const list = stories.filter(s => s.status.toLowerCase().replace(/\u00a0/g, ' ') === 'ƒëang ƒë·ªçc');
  document.getElementById('readingList').innerHTML = list.map(s=>`
    <a href="${s.youtubelink}" target="_blank" class="flex items-center p-4 bg-white rounded-xl shadow hover:shadow-lg transition group border border-gray-100">
      <div class="w-12 h-12 rounded-full bg-green-50 text-green-500 flex items-center justify-center mr-3 group-hover:bg-green-500 group-hover:text-white transition"><i class="fa-solid fa-play"></i></div>
      <div class="flex-1 overflow-hidden">
        <h4 class="font-bold text-gray-800 truncate group-hover:text-green-600">${s.title}</h4>
        <p class="text-xs text-gray-500">ƒêang ph√°t s√≥ng</p>
      </div>
    </a>`).join('');
}

function renderAdmin(){
  document.getElementById('adminTable').innerHTML=stories.map(s=>`
  <tr class="border-b hover:bg-gray-50">
    <td class="p-2 text-left font-medium text-sm truncate max-w-[120px]">${s.title}</td>
    <td><span class="px-2 py-1 text-[10px] rounded bg-gray-200">${s.status}</span></td>
    <td class="p-2">
      <button class="text-blue-600 mx-1" onclick="changeStatus(${s.id})"><i class="fa-solid fa-pen"></i></button>
      <button class="text-red-600 mx-1" onclick="deleteStory(${s.id})"><i class="fa-solid fa-trash"></i></button>
    </td>
  </tr>`).join('');
}

function changeStatus(id){
  const st=stories.find(s=>s.id===id);
  Swal.fire({title: 'Status', input: 'select', inputOptions: {'ƒë·ªÅ‚ÄØxu·∫•t': 'ƒê·ªÅ Xu·∫•t', 'ƒëang‚ÄØƒë·ªçc': 'ƒêang ƒê·ªçc', 'ho√†n th√†nh': 'Ho√†n Th√†nh', 'drop': 'Drop'}, inputValue: st.status.toLowerCase().replace(/\u00a0/g, ' '), showCancelButton: true})
  .then(r => {if(r.isConfirmed) {
      if(r.value.includes('ƒëang')) Swal.fire({title:'Link YT',input:'url',inputValue:st.youtubelink}).then(l=>{if(l.isConfirmed)updateStory(id,{status:'ƒëang ƒë·ªçc',youtubelink:l.value})});
      else updateStory(id,{status:r.value});
  }});
}

document.getElementById('formSuggest').addEventListener("submit",e=>{
  e.preventDefault();
  addStory({title:document.getElementById('title').value.trim(),linkstory:document.getElementById('linkStory').value.trim(),version:document.querySelector('input[name="version"]:checked')?.value||'',note:document.getElementById('note').value.trim(),votes:0,status:'ƒë·ªÅ‚ÄØxu·∫•t',youtubelink:'',createdat:new Date().toISOString()});
  e.target.reset();
});
document.getElementById('adminLoginBtn').addEventListener('click',async()=>{
  const {value:p}=await Swal.fire({title:'Admin Password',input:'password'});
  if(p==='hoiam20102003'){document.getElementById('admin').classList.remove('hidden');refreshAll();Swal.fire('Login Success','','success');}
});
document.getElementById('logoutBtn').addEventListener('click',()=>{document.getElementById('admin').classList.add('hidden');});

window.onload=fetchStories;
</script>
</body>
</html>
