<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Há»“iâ€¯Ã‚mâ€¯Äamâ€¯Má»¹â€¯â€“â€¯Cá»™ngâ€¯Ä‘á»“ngâ€¯Ä‘á»â€¯xuáº¥tâ€¯truyá»‡n</title>
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
body{font-family:'Poppins',sans-serif;color:#222;overflow-x:hidden;margin:0;}
canvas#stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-10;display:block;}
.glass{background:rgba(255,255,255,0.85);backdrop-filter:blur(10px);
Â  border:1px solid rgba(255,255,255,0.4);border-radius:20px;
Â  box-shadow:0 8px 30px rgba(0,0,0,0.1);}
.btn-gradient{background:linear-gradient(135deg,#7b1fa2,#00bcd4);color:#fff;
Â  border:none;border-radius:30px;font-weight:600;}
.table thead{background:linear-gradient(90deg,#7b1fa2,#00bcd4);color:#fff;}
footer{background:rgba(255,255,255,0.85);text-align:center;padding:1rem;font-weight:500;color:#4a148c;}
</style>
</head>

<body>

<canvas id="stars"></canvas>
<script>
const c=document.getElementById("stars"),x=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight;}window.onresize=resize;resize();
const stars=[...Array(220)].map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*1.2+0.2,
dx:(Math.random()-.5)*0.3,dy:(Math.random()-.5)*0.3}));
function draw(){
Â const g=x.createLinearGradient(0,0,c.width,c.height);
Â g.addColorStop(0,"#050014");g.addColorStop(1,"#16052F");
Â x.fillStyle=g;x.fillRect(0,0,c.width,c.height);
Â const neb=x.createRadialGradient(c.width/2,c.height/2,0,c.width/2,c.height/2,c.width/1.2);
Â neb.addColorStop(0,"rgba(128,0,255,0.25)");neb.addColorStop(1,"transparent");
Â x.fillStyle=neb;x.fillRect(0,0,c.width,c.height);
Â x.fillStyle="#fff";
Â for (const s of stars) {
Â  x.beginPath();
Â  x.arc(s.x, s.y, s.r, 0, Math.PI * 2);
Â  x.fill();

Â  s.x += s.dx;
Â  s.y += s.dy;

Â  if (s.x < 0) s.x = c.width;
Â  if (s.x > c.width) s.x = 0;
Â  if (s.y < 0) s.y = c.height;
Â  if (s.y > c.height) s.y = 0;Â 
}
requestAnimationFrame(draw);
}draw();
</script>

<nav class="fixed w-full backdrop-blur-md bg-white/70 shadow z-50">
Â  <div class="max-w-6xl mx-auto flex items-center justify-between p-3">
Â  Â  <a href="#home" class="text-xl sm:text-2xl font-bold text-indigo-600 flex items-center gap-2">
Â  Â  Â  <i class="fa-solid fa-headphones"></i>â€¯Há»“iâ€¯Ã‚mâ€¯Äamâ€¯Má»¹
Â  Â  </a>
Â  Â  Â  Â  <button id="menuBtn" class="sm:hidden text-2xl text-indigo-600" aria-label="Má»Ÿ menu di Ä‘á»™ng" role="button">
Â  Â  Â  <i class="fa-solid fa-bars"></i>
Â  Â  </button>
Â  Â  Â  Â  <div id="navLinks" class="hidden sm:flex flex-col sm:flex-row sm:items-center sm:space-x-6 absolute sm:static w-full sm:w-auto bg-white sm:bg-transparent left-0 top-14 sm:top-auto shadow sm:shadow-none text-gray-700 font-medium">
Â  Â  Â  <a href="#suggest" class="px-3 py-2 hover:text-indigo-500">Äá»â€¯xuáº¥t</a>
Â  Â  Â  <a href="#list" class="px-3 py-2 hover:text-indigo-500">Danhâ€¯sÃ¡ch</a>
Â  Â  Â  <a href="#reading" class="px-3 py-2 hover:text-indigo-500">Äangâ€¯Ä‘á»c</a>
Â  Â  Â  <button id="adminLoginBtn" class="px-3 py-2 text-pink-600 text-lg hover:text-pink-400" title="ÄÄƒng nháº­p quáº£n trá»‹" aria-label="ÄÄƒng nháº­p quáº£n trá»‹" role="button"><i class="fa-solid fa-lock"></i></button>
Â  Â  </div>
Â  </div>
</nav>
<script>
document.getElementById('menuBtn').addEventListener('click',()=>document.getElementById('navLinks').classList.toggle('hidden'));
</script>

<section id="home" class="pt-28 text-center text-white px-4">
Â  <h2 class="text-3xl font-bold text-indigo-200"><i class="fa-solid fa-star text-pink-300"></i>â€¯Topâ€¯Truyá»‡nâ€¯YÃªuâ€¯ThÃ­ch</h2>
Â  <div id="topStories" class="flex flex-wrap justify-center gap-6 mt-6"></div>
</section>

<section id="suggest" class="max-w-4xl mx-auto mt-20 p-4 sm:p-8 glass mx-4 sm:mx-auto">
Â  <h2 class="text-2xl font-semibold text-indigo-800"><i class="fa-solid fa-feather"></i>â€¯Äá»â€¯Xuáº¥tâ€¯Truyá»‡nâ€¯Má»›i</h2>
Â  <form id="formSuggest" class="grid gap-4 mt-4">
Â  Â  <input id="title" class="p-3 rounded-lg border border-indigo-200 w-full" placeholder="TÃªnâ€¯truyá»‡nâ€¦" required>
Â  Â  <input id="linkStory" type="url" class="p-3 rounded-lg border border-indigo-200 w-full" placeholder="Linkâ€¯truyá»‡nâ€¦">
Â  Â  <div class="flex flex-wrap items-center gap-3">
Â  Â  Â  <span class="font-medium">PhiÃªnâ€¯báº£n:</span>
Â  Â  Â  <label><input type="radio" name="version" value="Edit" required>â€¯Edit</label>
Â  Â  Â  <label><input type="radio" name="version" value="Convert">â€¯Convert</label>
Â  Â  </div>
Â  Â  <textarea id="note" class="p-3 rounded-lg border border-indigo-200 w-full" rows="2" placeholder="Ghiâ€¯chÃºâ€¯(Ä‘á»™â€¯dÃ i,â€¯thá»ƒâ€¯loáº¡iâ€¦)"></textarea>
Â  Â  <button class="py-3 btn-gradient shadow transition w-full sm:w-auto mx-auto" role="button" aria-label="Gá»­i Ä‘á» xuáº¥t truyá»‡n"><i class="fa-solid fa-paper-plane"></i>â€¯Gá»­iâ€¯Ä‘á»â€¯xuáº¥t</button>
Â  </form>
</section>

<section id="list" class="max-w-6xl mx-auto mt-20 p-4 sm:p-6 glass text-center mx-4 sm:mx-auto">
Â  <h2 class="text-2xl font-semibold text-indigo-800"><i class="fa-solid fa-list"></i>â€¯Danhâ€¯SÃ¡châ€¯Äá»â€¯Xuáº¥t</h2>
Â  <div class="overflow-x-auto mt-4">
Â  Â  <table class="min-w-[500px] w-full text-center text-sm sm:text-base table">
Â  Â  Â  <thead><tr><th>TÃªnâ€¯truyá»‡n</th><th>Báº£nâ€¯dá»‹ch</th><th>Ghiâ€¯chÃº</th><th>Vote</th><th>Äá»câ€¯truyá»‡n</th></tr></thead>
Â  Â  Â  <tbody id="storyList"></tbody>
Â  Â  </table>
Â  </div>
</section>

<section id="reading" class="max-w-4xl mx-auto mt-20 p-4 sm:p-6 glass text-center mx-4 sm:mx-auto">
Â  <h2 class="text-2xl font-semibold text-indigo-800"><i class="fa-solid fa-headphones"></i>â€¯Truyá»‡nâ€¯Äangâ€¯Äá»c</h2>
Â  <div id="readingList" class="space-y-3 mt-4"></div>
</section>

<section id="admin" class="hidden max-w-6xl mx-auto mt-20 mb-10 p-4 sm:p-6 glass text-center mx-4 sm:mx-auto">
Â  <h2 class="text-2xl font-semibold text-indigo-800"><i class="fa-solid fa-user-shield"></i>â€¯Quáº£nâ€¯LÃ½</h2>
Â  <div class="text-center mb-4">
Â  Â  <button class="px-4 py-2 bg-gray-400 text-white rounded" id="logoutBtn" role="button" aria-label="ÄÄƒng xuáº¥t quáº£n trá»‹"><i class="fa-solid fa-right-from-bracket"></i>â€¯ÄÄƒngâ€¯xuáº¥t</button>
Â  </div>
Â  <div id="adminPanel" class="overflow-x-auto">
Â  Â  <table class="min-w-[600px] w-full text-center text-sm sm:text-base table">
Â  Â  Â  <thead><tr><th>TÃªn</th><th>Tráº¡ngâ€¯thÃ¡i</th><th>YouTube</th><th>HÃ nhâ€¯Ä‘á»™ng</th></tr></thead>
Â  Â  Â  <tbody id="adminTable"></tbody>
Â  Â  </table>
Â  </div>
</section>

<footer>Â©â€¯2025â€¯Há»“iâ€¯Ã‚mâ€¯Äamâ€¯Má»¹â€¯â€¢â€¯VÅ©â€¯trá»¥â€¯cáº£mâ€¯xÃºcâ€¯vÃ â€¯Ã¢mâ€¯thanhâ€¯âœ¨</footer>

<script>
const SUPABASE_URL='https://xklmcebwxkqbotqexprn.supabase.co';
const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhrbG1jZWJ3eGtxYm90cWV4cHJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2MzM1NDEsImV4cCI6MjA3OTIwOTU0MX0.vZj-5C_HhVgemG0LOTH3axf4P0bxXngzeQ3PSo93-m4';
const TABLE='stories';
let stories=[];

async function fetchStories(){
Â  const res=await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}?select=*`,
Â  Â  {headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
Â  stories=await res.json();refresh();
}
async function addStory(s){
Â  const res=await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}`,{
Â  Â  method:'POST',
Â  Â  headers:{'Content-Type':'application/json',apikey:SUPABASE_KEY,
Â  Â  Â  Authorization:`Bearer ${SUPABASE_KEY}`,Prefer:'return=representation'},
Â  Â  body:JSON.stringify(s)
Â  });
Â  const txt=await res.text();
Â  if(!res.ok){Swal.fire('Lá»—i',txt,'error');return;}
Â  const data=JSON.parse(txt);stories.push(data[0]);refresh();
Â  Swal.fire('ğŸŒ¸','ÄÃ£â€¯lÆ°uâ€¯Ä‘á»â€¯xuáº¥t!','success');
}
async function updateStory(id,d){
Â  await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}?id=eq.${id}`,{
Â  Â  method:'PATCH',
Â  Â  headers:{'Content-Type':'application/json',apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`},
Â  Â  body:JSON.stringify(d)
Â  });fetchStories();
}
async function deleteStory(id){
Â  const st=stories.find(s=>s.id===id);
Â  const cf=await Swal.fire({title:`XÃ³aâ€¯"${st.title}"?`,text:'KhÃ´ngâ€¯thá»ƒâ€¯hoÃ nâ€¯tÃ¡c!',icon:'warning',showCancelButton:true});
Â  if(!cf.isConfirmed)return;
Â  const res=await fetch(`${SUPABASE_URL}/rest/v1/${TABLE}?id=eq.${id}`,{method:'DELETE',headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
Â  if(res.ok){Swal.fire('ğŸ—‘â€¯ÄÃ£â€¯xÃ³a','','success');fetchStories();}
}
async function toggleVote(id){
Â  const key=`vote_${id}`,st=stories.find(s=>s.id===id);let v=st.votes||0;
Â  if(localStorage.getItem(key)){localStorage.removeItem(key);v=Math.max(0,v-1);}else{localStorage.setItem(key,true);v++;}
Â  await updateStory(id,{votes:v});
}
function userVoted(id){return localStorage.getItem(`vote_${id}`);}

formSuggest.addEventListener("submit",async e=>{
Â  e.preventDefault();
Â  const s={
Â  Â  title:document.getElementById('title').value.trim(),
Â  Â  linkstory:document.getElementById('linkStory').value.trim(),
Â  Â  version:document.querySelector('input[name="version"]:checked')?.value||'',
Â  Â  note:document.getElementById('note').value.trim(),
Â  Â  votes:0,status:'Ä‘á»â€¯xuáº¥t',youtubelink:'',createdat:new Date().toISOString()
Â  };
Â  if(!s.title)return;await addStory(s);e.target.reset();
});

function refresh(){renderTop();renderList();renderReading();renderAdmin();}
function renderTop(){
Â let c=topStories;c.innerHTML='';
Â const top=[...stories.filter(s=>s.status==='Ä‘á»â€¯xuáº¥t')].sort((a,b)=>b.votes-a.votes).slice(0,5);
Â top.forEach(s=>c.innerHTML+=`
Â <div class="w-48 sm:w-60 p-5 bg-white/80 rounded-xl shadow hover:scale-105 transition">
Â  Â <h5 class="font-bold text-indigo-700">${s.title}</h5>
Â  Â <p class="text-sm text-gray-600">${s.note||''}</p>
Â  Â <span class="text-pink-600 font-semibold">${s.votes}â€¯vote</span>
Â </div>`);}
function renderList(){
Â storyList.innerHTML=stories.filter(s=>s.status==='Ä‘á»â€¯xuáº¥t').map(s=>`
Â <tr class="even:bg-white/40 odd:bg-white/70">
Â <td class="p-2"><a href='${s.linkstory}' target='_blank'>${s.title}</a></td>
Â <td>${s.version}</td><td>${s.note||''}</td>
Â <td>
Â <button class='px-3 py-1 rounded-full ${userVoted(s.id)?'bg-red-400 text-white':'border border-indigo-400 text-indigo-600'}' onclick='toggleVote(${s.id})' role="button" aria-label="${userVoted(s.id)?'Bá» vote':'Vote'}">
Â ${userVoted(s.id)?'Bá»â€¯vote':'Vote'}</button><div>${s.votes}</div>
Â </td>
Â <td>
Â  Â  Â  Â  Â  ${
Â  Â  Â  Â  Â  Â  s.linkstory
Â  Â  Â  Â  Â  Â  Â  ? `<a href="${s.linkstory}" target="_blank"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â class="inline-block bg-indigo-500 text-white text-sm px-3 py-1 rounded-full hover:bg-indigo-600 transition">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <i class="fa-solid fa-book-open"></i>â€¯Äá»c
Â  Â  Â  Â  Â  Â  Â  Â  Â </a>`
Â  Â  Â  Â  Â  Â  Â  : '<span class="text-gray-400 italic">KhÃ´ngâ€¯cÃ³â€¯link</span>'
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  </td></tr>`).join('');
Â Â 
}
function renderReading(){
Â readingList.innerHTML=stories.filter(s=>s.status==='Ä‘angâ€¯Ä‘á»c').map(s=>`
Â <a href='${s.youtubelink}' target='_blank' class='block p-4 bg-white/80 rounded-xl shadow hover:bg-white transition' role="button" aria-label="Nghe truyá»‡n ${s.title}">
Â <div class='flex justify-between items-center'>
Â <div><strong>${s.title}</strong><br><small>${s.note||''}</small></div>
Â <span class='bg-green-400 text-white px-3 py-1 rounded-full'>Nghe</span></div></a>`).join('');
}
function renderAdmin(){
Â adminTable.innerHTML=stories.map(s=>`
Â <tr class='even:bg-white/40 odd:bg-white/70'>
Â <td>${s.title}</td><td>${s.status}</td><td>${s.youtubelink||'-'}</td>
Â <td class='space-x-2'>
Â  Â <button class='px-3 py-1 bg-yellow-400 rounded' onclick='changeStatus(${s.id})' role="button" aria-label="Äá»•i tráº¡ng thÃ¡i truyá»‡n ${s.title}">Äá»•i</button>
Â  Â <button class='px-3 py-1 bg-red-500 text-white rounded' onclick='deleteStory(${s.id})' role="button" aria-label="XÃ³a truyá»‡n ${s.title}"><i class='fa-solid fa-trash'></i></button>
Â </td></tr>`).join('');
}
function changeStatus(id){
Â const st=stories.find(s=>s.id===id);
Â Swal.fire({title:'Chá»nâ€¯tráº¡ngâ€¯thÃ¡i',input:'select',
Â inputOptions:{'Ä‘á»â€¯xuáº¥t':'Äá»â€¯xuáº¥t','Ä‘angâ€¯Ä‘á»c':'Äangâ€¯Ä‘á»c','Ä‘Ã£â€¯Ä‘á»c':'ÄÃ£â€¯Ä‘á»c'},
Â inputValue:st.status,showCancelButton:true})
Â .then(r=>{
Â  Â if(!r.isConfirmed)return;
Â  Â if(r.value==='Ä‘angâ€¯Ä‘á»c'){
Â  Â  Â Swal.fire({title:'Linkâ€¯YouTube',input:'url',showCancelButton:true})
Â  Â  Â .then(l=>{if(l.isConfirmed)updateStory(id,{status:r.value,youtubelink:l.value});});
Â  Â }else updateStory(id,{status:r.value});
Â });
}

/* === ÄÄƒng nháº­p/Ä‘Äƒng xuáº¥tâ€¯Admin === */
document.getElementById('adminLoginBtn').addEventListener('click',async()=>{
Â  const {value:pass}=await Swal.fire({title:'Nháº­pâ€¯máº­tâ€¯kháº©uâ€¯Admin',input:'password',inputPlaceholder:'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢',confirmButtonText:'ÄÄƒngâ€¯nháº­p',showCancelButton:true});
Â  if(pass==='hoiam20102003'){document.getElementById('admin').classList.remove('hidden');adminPanel.style.display='block';renderAdmin();Swal.fire('âœ…','ÄÄƒngâ€¯nháº­pâ€¯adminâ€¯thÃ nhâ€¯cÃ´ng!','success');}
Â  else if(pass){Swal.fire('Saiâ€¯máº­tâ€¯kháº©u','','error');}
});
document.getElementById('logoutBtn').addEventListener('click',()=>{
Â  document.getElementById('admin').classList.add('hidden');
Â  Swal.fire('ğŸšª','ÄÃ£â€¯Ä‘Äƒngâ€¯xuáº¥t','info');
});

window.onload=fetchStories;
</script>
</body>
</html>
